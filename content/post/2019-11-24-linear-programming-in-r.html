---
title: Allocation Model in R
author: Anthony Yoskovich
date: '2019-11-24'
tags:
  - operations research
slug: linear-programming-in-r
editor_options:
  chunk_output_type: console
---



<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this post I demonstrate how to solve an allocation problem using the <code>lpSolve</code> package in R. I would probably prefer using <code>AMPL</code> to solve LP problems due to its readable syntax and ease of scalability. When using <code>R</code>, it’s easy to forget the underlying mathematical models that are being translated. However, with <code>AMPL</code> my brain feels more in the “math mode” (if that makes any sense lol). For unfamiliar readers, <a href="https://www.me.utexas.edu/~jensen/ORMM/models/unit/linear/subunits/resource_allocation/index.html">here</a> is a good explanation of the allocation model.</p>
<div id="allocation-model" class="section level3">
<h3>1. Allocation Model</h3>
<p>I’m going to skip over the contextual details of the problem and just provide the mathematical model. This problem comes from Example 4.1 of <em>Optimization in Operations Research (Rearden 2015)</em>.</p>
<p><span class="math display">\[
\begin{align}
  \max{} &amp; \quad 2h_1 + 3h_2 + h_3 + 5h_4\\
  \\
  \text{s.t.} &amp; \notag \\
  \\
  &amp;\sum_{j=1}^{4} h_j = 30 \\
  &amp;h_1 \ge h_j \quad &amp;j = 2,...4\\
  &amp;h_j \le 10 \quad &amp;j = 1,...4 \\
  &amp;h_j \ge 0 \quad &amp;j = 1,...4 \\
\end{align}
\]</span></p>
<p><span class="math inline">\(h_j \equiv\)</span> Number of hours <span class="math inline">\(h\)</span> spent studying the <span class="math inline">\(j\)</span>th subject.</p>
<p>It immediately becomes apparent that each of the constraints are not explicitly written out. Instead, a few are written using the for all notation, something that <code>lpSolve</code> doesn’t support.</p>
<p>Translating the constraints into a format readily usable by <code>lpSolve</code> is a tad bit tedious but I’ll discuss this more later on. First I’ll define the coefficients for the objective function.</p>
<pre class="r"><code>coeff &lt;- c(2, 3, 1, 5)</code></pre>
<p>Now I create the constraint matrix (this is where some translation is needed to use <code>lpSolve</code>)</p>
<pre class="r"><code>A &lt;- matrix(c(1, 1, 1, 1, # Sum to 30
              
              1, -1, 0, 0, # h_1 is greatest
              1, 0, -1, 0,
              1, 0, 0, -1,
              
              1, 0, 0, 0, # max of 10
              0, 1, 0, 0,
              0, 0, 1, 0,
              0, 0, 0, 1,
              
              1, 0, 0, 0, # non negativity
              0, 1, 0, 0,
              0, 0, 1, 0,
              0, 0, 0, 1),
            ncol=4,
            byrow=TRUE)</code></pre>
<p>Create the RHS for the constraints and define the directions.</p>
<pre class="r"><code>RHS &lt;- c(30, # Sum to 30
         
         0, # h_1 is greatest
         0, 
         0,
         
         10, # max of 10
         10, 
         10,
         10,
         
         0, # non negativity
         0, 
         0,
         0)

directions &lt;- c(&#39;=&#39;, # Sum to 30
                
                &#39;&gt;=&#39;, # h_1 is greatest
                &#39;&gt;=&#39;,
                &#39;&gt;=&#39;,
                
                &#39;&lt;=&#39;, # max of 10
                &#39;&lt;=&#39;,
                &#39;&lt;=&#39;,
                &#39;&lt;=&#39;,
                
                &#39;&gt;=&#39;, # non negativity
                &#39;&gt;=&#39;,
                &#39;&gt;=&#39;,
                &#39;&gt;=&#39;)</code></pre>
<p>Now use the <code>lp()</code> function to solve the model.</p>
<pre class="r"><code>optimum &lt;-  lp(direction=&quot;min&quot;,
               objective.in = coeff,
               const.mat = A,
               const.dir = directions,
               const.rhs = RHS,
               all.int = T) # All integers

optimum$solution</code></pre>
<pre><code>## [1] 10 10 10  0</code></pre>
<p>Inputing this simple model was tedious. I could have cleaned up the constraint directions by using <code>rep()</code> function or something, but I don’t see that being something that I could ever get used to.</p>
</div>
</div>
<div id="final-note" class="section level1">
<h1>Final Note</h1>
<p><code>AMPL</code> is another (although not free) way to solve these types of problems and offers a significantly more elegant syntax. For example, the below chunk solves the same problem and is very extensible right out of the box. I may break down some OR problems in <code>AMPL</code> in future posts.</p>
<pre><code>model;

set subjects;
param productivity{subjects};

var hours{subjects} &gt;= 0;

maximize TotalScore:
    sum{i in subjects} hours[i]*productivity[i];
    
subject to
    totalHours: 
        sum{i in subjects} hours[i] = 30;
    
    maxTen {i in subjects}:
        hours[i] &lt;= 10;

data;

set subjects := s1 s2 s3 s4;

param: productivity :=
    s1   2
    s2   3
    s3   1
    s4   5
;

solve;
display hours;</code></pre>
</div>
